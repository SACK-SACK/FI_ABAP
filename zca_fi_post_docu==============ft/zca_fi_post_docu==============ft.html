<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZCA_FI_POST_DOCU==============FT</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZCA_FI_POST_DOCU==============FT</b></font>
<hr>
<pre width="100">
REPORT ZCA_FI_POST_DOCU==============FT.
<font color ="#0000FF">* 2.0</font>
<font color ="#0000FF">*</font>
DATA: TIME1 TYPE P, TIME2 TYPE P, RUNTIME(30), DEBUG, ATRA.
DATA: RC LIKE SY-SUBRC , V_RC LIKE SY-SUBRC.
DATA: DESTI LIKE RFCDES-RFCDEST.
DATA: FIELDNAME LIKE SY-REPID.
DATA: G_UPPER TYPE C.         "Gross/Kleinschreibung
<font color ="#0000FF">*</font>
TABLES : EUFUNC.
DATA: BEGIN OF UNTERSCHIED,            " Unterschiede bei Testdur
        PARAMETER(30),
        ALT(200),
        NEU(200),                      " laufen
      END OF UNTERSCHIED.
<font color ="#0000FF">*</font>
DATA : D102N_EXPORTKEY LIKE FUNCTDIR.
<font color ="#0000FF">*</font>
DATA : BEGIN OF EXPORTKEY,
         DATAID LIKE EUFUNC-NUMMER,
         SEQID  LIKE EUFUNC-SEQID,
       END OF EXPORTKEY.
DATA : BEGIN OF EXCEPTIONS OCCURS 10,
         NAME(30),
       END OF EXCEPTIONS.
DATA : VEXCEPTION(30).
DATA : OEXCEPTION(30).
DATA : NR2(250) TYPE C.
DATA : TABLEN TYPE I.
DATA : EX TYPE REF TO CX_ROOT.
DATA : DESCR_REF TYPE REF TO CL_ABAP_TYPEDESCR.
DATA : RESULTAT(30) TYPE C.
DATA : REST(30)     TYPE C.
<font color ="#0000FF">*</font>
DATA: %_IIV_BUKRS TYPE ZCA_BUKRS VALUE '1001'.
DATA: %_IIV_GJAHR TYPE ZCA_GJAHR.
DATA: %_IIV_BELNR TYPE ZCA_BELNR.
DATA: %_IIV_BLART TYPE ZCA_BLART.
DATA: %_IIV_BLDAT TYPE ZCA_BLDAT.
DATA: %_IIV_BUDAT TYPE ZCA_BUDAT.
DATA: %_IIV_BLTXT TYPE ZCA_BLTXT.
DATA: %_IIV_XBLNR TYPE ZCA_XBLNR.
DATA: %_IIV_BSCHL TYPE ZCA_BSCHL.
DATA: %_IIV_SAKNR TYPE ZCA_SAKNR.
DATA: %_IIV_DMBTR TYPE ZCA_DMBTR.
DATA: %_IIV_WAERS TYPE ZCA_WAERS.
DATA: %_IIV_BPCODE TYPE ZCA_BPCODE.
DATA: %_IIV_AUGDT TYPE ZCA_AUGDT.
DATA: %_IIV_AUGBL TYPE ZCA_AUGBL.
DATA: %_OEV_BUKRS TYPE ZCA_BUKRS.
DATA: %_VEV_BUKRS TYPE ZCA_BUKRS.
DATA: %_OEV_BELNR TYPE ZCA_BELNR.
DATA: %_VEV_BELNR TYPE ZCA_BELNR.
DATA: %_OEV_GJAHR TYPE ZCA_GJAHR.
DATA: %_VEV_GJAHR TYPE ZCA_GJAHR.
DATA: %_OEV_ITNUM TYPE ZCA_ITNUM.
DATA: %_VEV_ITNUM TYPE ZCA_ITNUM.
FORM EXISTENCE_CHECK CHANGING VARIA.
  VARIA = 1.
ENDFORM.
FORM FUNCTION_CALL.
  CLEAR %_OEV_BUKRS.
  CLEAR %_OEV_BELNR.
  CLEAR %_OEV_GJAHR.
  CLEAR %_OEV_ITNUM.
<font color ="#0000FF">*  TRANSAKTION = 'Repo', PROGRAM = REPORT</font>
  IF ATRA = '1'.
    SET RUN TIME ANALYZER ON %_INTERNAL.
  ENDIF.
IF DESTI IS INITIAL.
IF DEBUG = '1'. BREAK-POINT AT NEXT APPLICATION STATEMENT.
ENDIF.
DEBUG = SPACE.
GET RUN TIME FIELD TIME1.
CALL FUNCTION 'ZCA_FI_POST_DOCU'
EXPORTING
IV_BUKRS = %_IIV_BUKRS
IV_GJAHR = %_IIV_GJAHR
IV_BELNR = %_IIV_BELNR
IV_BLART = %_IIV_BLART
IV_BLDAT = %_IIV_BLDAT
IV_BUDAT = %_IIV_BUDAT
IV_BLTXT = %_IIV_BLTXT
IV_XBLNR = %_IIV_XBLNR
IV_BSCHL = %_IIV_BSCHL
IV_SAKNR = %_IIV_SAKNR
IV_DMBTR = %_IIV_DMBTR
IV_WAERS = %_IIV_WAERS
IV_BPCODE = %_IIV_BPCODE
IV_AUGDT = %_IIV_AUGDT
IV_AUGBL = %_IIV_AUGBL
IMPORTING
EV_BUKRS = %_OEV_BUKRS
EV_BELNR = %_OEV_BELNR
EV_GJAHR = %_OEV_GJAHR
EV_ITNUM = %_OEV_ITNUM.
  IF ATRA = '1'.
    SET RUN TIME ANALYZER OFF %_INTERNAL.
  ENDIF.
ELSE.
GET RUN TIME FIELD TIME1.
<font color ="#0000FF">*  TRANSAKTION = 'Repo', PROGRAM = REPORT</font>
  IF ATRA = '1'.
    SET RUN TIME ANALYZER ON %_INTERNAL.
  ENDIF.
IF DESTI = 'SPACE'.
  DESTI = ' '.
ENDIF.
CALL FUNCTION 'ZCA_FI_POST_DOCU' DESTINATION DESTI
EXPORTING
IV_BUKRS = %_IIV_BUKRS
IV_GJAHR = %_IIV_GJAHR
IV_BELNR = %_IIV_BELNR
IV_BLART = %_IIV_BLART
IV_BLDAT = %_IIV_BLDAT
IV_BUDAT = %_IIV_BUDAT
IV_BLTXT = %_IIV_BLTXT
IV_XBLNR = %_IIV_XBLNR
IV_BSCHL = %_IIV_BSCHL
IV_SAKNR = %_IIV_SAKNR
IV_DMBTR = %_IIV_DMBTR
IV_WAERS = %_IIV_WAERS
IV_BPCODE = %_IIV_BPCODE
IV_AUGDT = %_IIV_AUGDT
IV_AUGBL = %_IIV_AUGBL
IMPORTING
EV_BUKRS = %_OEV_BUKRS
EV_BELNR = %_OEV_BELNR
EV_GJAHR = %_OEV_GJAHR
EV_ITNUM = %_OEV_ITNUM.
  IF ATRA = '1'.
    SET RUN TIME ANALYZER OFF %_INTERNAL.
  ENDIF.
  ENDIF.
  GET RUN TIME FIELD TIME2.
  RC = SY-SUBRC.
  CLEAR EXCEPTIONS.
  READ TABLE EXCEPTIONS INDEX RC.
  IF SY-SUBRC = 0.
  OEXCEPTION = EXCEPTIONS-NAME.
  ELSE.
  OEXCEPTION = RESULTAT.
  ENDIF.
  TIME1 = TIME2 - TIME1.
  WRITE TIME1 TO RUNTIME.
  CONDENSE RUNTIME.
ENDFORM.

FORM CLEAR_DATA.
  CLEAR %_IIV_BUKRS.
  CLEAR %_IIV_GJAHR.
  CLEAR %_IIV_BELNR.
  CLEAR %_IIV_BLART.
  CLEAR %_IIV_BLDAT.
  CLEAR %_IIV_BUDAT.
  CLEAR %_IIV_BLTXT.
  CLEAR %_IIV_XBLNR.
  CLEAR %_IIV_BSCHL.
  CLEAR %_IIV_SAKNR.
  CLEAR %_IIV_DMBTR.
  CLEAR %_IIV_WAERS.
  CLEAR %_IIV_BPCODE.
  CLEAR %_IIV_AUGDT.
  CLEAR %_IIV_AUGBL.
  CLEAR %_VEV_BUKRS.
  CLEAR %_OEV_BUKRS.
  CLEAR %_VEV_BELNR.
  CLEAR %_OEV_BELNR.
  CLEAR %_VEV_GJAHR.
  CLEAR %_OEV_GJAHR.
  CLEAR %_VEV_ITNUM.
  CLEAR %_OEV_ITNUM.
ENDFORM.
FORM CLEAR_TABLE.
ENDFORM.
FORM DELETE_LINE USING KEY INDEX.
CASE KEY.
ENDCASE.
ENDFORM.
FORM INIT_EXCEPTIONS USING NAME.
  CLEAR EXCEPTIONS.
  MOVE NAME TO EXCEPTIONS-NAME.
  APPEND EXCEPTIONS.
ENDFORM.
FORM PARAM_ACCESS_TYPES USING KEY DEST P_MODE P_UPPER.
DATA : INTKEY(31).
  P_UPPER = G_UPPER.
  INTKEY = DEST.
  INTKEY+1 = KEY.
  CONDENSE INTKEY.
  CASE INTKEY.
    WHEN 'IIV_BUKRS'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_BUKRS'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_BUKRS.
    WHEN 'IIV_GJAHR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_GJAHR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_GJAHR.
    WHEN 'IIV_BELNR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_BELNR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_BELNR.
    WHEN 'IIV_BLART'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_BLART'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_BLART.
    WHEN 'IIV_BLDAT'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_BLDAT'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_BLDAT.
    WHEN 'IIV_BUDAT'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_BUDAT'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_BUDAT.
    WHEN 'IIV_BLTXT'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_BLTXT'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_BLTXT.
    WHEN 'IIV_XBLNR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_XBLNR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_XBLNR.
    WHEN 'IIV_BSCHL'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_BSCHL'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_BSCHL.
    WHEN 'IIV_SAKNR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_SAKNR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_SAKNR.
    WHEN 'IIV_DMBTR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_DMBTR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_DMBTR.
    WHEN 'IIV_WAERS'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_WAERS'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_WAERS.
    WHEN 'IIV_BPCODE'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_BPCODE'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_BPCODE.
    WHEN 'IIV_AUGDT'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_AUGDT'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_AUGDT.
    WHEN 'IIV_AUGBL'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IV_AUGBL'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIV_AUGBL.
    WHEN 'OEV_BUKRS'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'EV_BUKRS'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OEV_BUKRS.
    WHEN 'VEV_BUKRS'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'EV_BUKRS'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VEV_BUKRS.
    WHEN 'OEV_BELNR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'EV_BELNR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OEV_BELNR.
    WHEN 'VEV_BELNR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'EV_BELNR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VEV_BELNR.
    WHEN 'OEV_GJAHR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'EV_GJAHR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OEV_GJAHR.
    WHEN 'VEV_GJAHR'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'EV_GJAHR'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VEV_GJAHR.
    WHEN 'OEV_ITNUM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'EV_ITNUM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OEV_ITNUM.
    WHEN 'VEV_ITNUM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'EV_ITNUM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VEV_ITNUM.
  ENDCASE.
ENDFORM.
FORM PARAMETER_SET USING NAME DIRECTION VALUE.
 DATA: L_NAME(31).
 CONCATENATE DIRECTION NAME INTO L_NAME.
CASE L_NAME.
WHEN 'IIV_BUKRS'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_BUKRS.
WHEN 'IIV_GJAHR'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_GJAHR.
WHEN 'IIV_BELNR'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_BELNR.
WHEN 'IIV_BLART'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_BLART.
WHEN 'IIV_BLDAT'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_BLDAT.
WHEN 'IIV_BUDAT'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_BUDAT.
WHEN 'IIV_BLTXT'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_BLTXT.
WHEN 'IIV_XBLNR'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_XBLNR.
WHEN 'IIV_BSCHL'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_BSCHL.
WHEN 'IIV_SAKNR'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_SAKNR.
WHEN 'IIV_DMBTR'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_DMBTR.
WHEN 'IIV_WAERS'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_WAERS.
WHEN 'IIV_BPCODE'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_BPCODE.
WHEN 'IIV_AUGDT'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_AUGDT.
WHEN 'IIV_AUGBL'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IIV_AUGBL.
WHEN 'OEV_BUKRS'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_OEV_BUKRS.
WHEN 'OEV_BELNR'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_OEV_BELNR.
WHEN 'OEV_GJAHR'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_OEV_GJAHR.
WHEN 'OEV_ITNUM'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_OEV_ITNUM.
ENDCASE.
ENDFORM.
FORM PARAMETER_GET USING NAME DIRECTION
                   CHANGING   VALUE
                            OLD_VALUE.
 DATA: L_NAME(31).
 CONCATENATE DIRECTION NAME INTO L_NAME.
CASE L_NAME.
WHEN 'IIV_BUKRS'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BUKRS
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BUKRS
   CHANGING OLD_VALUE.
WHEN 'IIV_GJAHR'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_GJAHR
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_GJAHR
   CHANGING OLD_VALUE.
WHEN 'IIV_BELNR'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BELNR
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BELNR
   CHANGING OLD_VALUE.
WHEN 'IIV_BLART'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BLART
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BLART
   CHANGING OLD_VALUE.
WHEN 'IIV_BLDAT'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BLDAT
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BLDAT
   CHANGING OLD_VALUE.
WHEN 'IIV_BUDAT'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BUDAT
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BUDAT
   CHANGING OLD_VALUE.
WHEN 'IIV_BLTXT'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BLTXT
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BLTXT
   CHANGING OLD_VALUE.
WHEN 'IIV_XBLNR'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_XBLNR
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_XBLNR
   CHANGING OLD_VALUE.
WHEN 'IIV_BSCHL'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BSCHL
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BSCHL
   CHANGING OLD_VALUE.
WHEN 'IIV_SAKNR'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_SAKNR
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_SAKNR
   CHANGING OLD_VALUE.
WHEN 'IIV_DMBTR'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_DMBTR
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_DMBTR
   CHANGING OLD_VALUE.
WHEN 'IIV_WAERS'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_WAERS
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_WAERS
   CHANGING OLD_VALUE.
WHEN 'IIV_BPCODE'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BPCODE
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_BPCODE
   CHANGING OLD_VALUE.
WHEN 'IIV_AUGDT'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_AUGDT
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_AUGDT
   CHANGING OLD_VALUE.
WHEN 'IIV_AUGBL'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_AUGBL
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIV_AUGBL
   CHANGING OLD_VALUE.
WHEN 'OEV_BUKRS'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OEV_BUKRS
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OEV_BUKRS
   CHANGING OLD_VALUE.
WHEN 'OEV_BELNR'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OEV_BELNR
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OEV_BELNR
   CHANGING OLD_VALUE.
WHEN 'OEV_GJAHR'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OEV_GJAHR
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OEV_GJAHR
   CHANGING OLD_VALUE.
WHEN 'OEV_ITNUM'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OEV_ITNUM
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OEV_ITNUM
   CHANGING OLD_VALUE.
ENDCASE.
ENDFORM.
FORM PARAMETER_TABLE_SET USING NAME VALUE.
CASE NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_TABLE_GET USING NAME
                   CHANGING   VALUE.
CASE NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_DESCRIBE USING CBPROG
                              NAME.
CASE NAME.
WHEN 'IV_BUKRS'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_BUKRS
         NAME.
WHEN 'IV_GJAHR'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_GJAHR
         NAME.
WHEN 'IV_BELNR'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_BELNR
         NAME.
WHEN 'IV_BLART'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_BLART
         NAME.
WHEN 'IV_BLDAT'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_BLDAT
         NAME.
WHEN 'IV_BUDAT'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_BUDAT
         NAME.
WHEN 'IV_BLTXT'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_BLTXT
         NAME.
WHEN 'IV_XBLNR'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_XBLNR
         NAME.
WHEN 'IV_BSCHL'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_BSCHL
         NAME.
WHEN 'IV_SAKNR'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_SAKNR
         NAME.
WHEN 'IV_DMBTR'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_DMBTR
         NAME.
WHEN 'IV_WAERS'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_WAERS
         NAME.
WHEN 'IV_BPCODE'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_BPCODE
         NAME.
WHEN 'IV_AUGDT'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_AUGDT
         NAME.
WHEN 'IV_AUGBL'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IIV_AUGBL
         NAME.
WHEN 'EV_BUKRS'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OEV_BUKRS
         NAME.
WHEN 'EV_BELNR'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OEV_BELNR
         NAME.
WHEN 'EV_GJAHR'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OEV_GJAHR
         NAME.
WHEN 'EV_ITNUM'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OEV_ITNUM
         NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_CONTAINER TABLES LCONT STRUCTURE SWCONT
                         USING NAME
                               DIRECTION .
CASE NAME.
WHEN 'IIV_BUKRS'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_BUKRS
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_BUKRS
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_GJAHR'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_GJAHR
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_GJAHR
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_BELNR'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_BELNR
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_BELNR
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_BLART'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_BLART
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_BLART
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_BLDAT'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_BLDAT
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_BLDAT
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_BUDAT'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_BUDAT
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_BUDAT
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_BLTXT'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_BLTXT
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_BLTXT
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_XBLNR'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_XBLNR
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_XBLNR
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_BSCHL'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_BSCHL
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_BSCHL
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_SAKNR'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_SAKNR
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_SAKNR
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_DMBTR'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_DMBTR
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_DMBTR
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_WAERS'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_WAERS
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_WAERS
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_BPCODE'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_BPCODE
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_BPCODE
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_AUGDT'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_AUGDT
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_AUGDT
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IIV_AUGBL'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IIV_AUGBL
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IIV_AUGBL
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OEV_BUKRS'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OEV_BUKRS
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OEV_BUKRS
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OEV_BELNR'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OEV_BELNR
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OEV_BELNR
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OEV_GJAHR'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OEV_GJAHR
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OEV_GJAHR
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OEV_ITNUM'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OEV_ITNUM
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OEV_ITNUM
TABLES
CONTAINER = LCONT.
ENDIF.
ENDCASE.
ENDFORM.
FORM TABLES_CONTAINER TABLES LCONT STRUCTURE SWCONT
                      USING NAME
                            DIRECTION.
CASE NAME.
ENDCASE.
ENDFORM.
FORM SET_VARIABLES USING KEY VALUE.
  CASE KEY.
    WHEN '%%DEBUGON'.
      DEBUG = 1.
    WHEN '%%DEBUGOFF'.
      DEBUG = 0.
    WHEN '%%DESTI'.
      DESTI = VALUE.
    WHEN '%%ATRAON'.
      ATRA = 1.
    WHEN '%%ATRAOFF'.
      ATRA = 0.
    WHEN '%%UPPER'.
      G_UPPER = VALUE.
  ENDCASE.
ENDFORM.
FORM GET_VARIABLES USING    KEY
                   CHANGING VALUE.
  CASE KEY.
    WHEN '%%DEBUG'.
      VALUE = DEBUG.
    WHEN '%%DESTI'.
      VALUE = DESTI.
    WHEN '%%ATRA'.
      VALUE = ATRA.
    WHEN '%%SUBRC'.
      VALUE = RC.
    WHEN 'V%%SUBRC'.
      VALUE = V_RC.
    WHEN '%%TIME'.
      VALUE = RUNTIME.
    WHEN '%%UPPER'.
      VALUE = G_UPPER.
    WHEN '%%EXCCL'.
      VALUE = RESULTAT.
  ENDCASE.
ENDFORM.
FORM GET_EXC_CL CHANGING P_EXC_CL.
   IF EX IS BOUND.
       P_EXC_CL = EX.
     ELSE.
       CLEAR P_EXC_CL.
   ENDIF.
ENDFORM.
FORM PARAMETER_READ_INPUT USING NAME
                                KEY
                       CHANGING VALUE.
  CASE NAME.
    WHEN 'IV_BUKRS'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BUKRS
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_BUKRS.
    WHEN 'IV_GJAHR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_GJAHR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_GJAHR.
    WHEN 'IV_BELNR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BELNR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_BELNR.
    WHEN 'IV_BLART'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BLART
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_BLART.
    WHEN 'IV_BLDAT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BLDAT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_BLDAT.
    WHEN 'IV_BUDAT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BUDAT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_BUDAT.
    WHEN 'IV_BLTXT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BLTXT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_BLTXT.
    WHEN 'IV_XBLNR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_XBLNR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_XBLNR.
    WHEN 'IV_BSCHL'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BSCHL
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_BSCHL.
    WHEN 'IV_SAKNR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_SAKNR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_SAKNR.
    WHEN 'IV_DMBTR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_DMBTR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_DMBTR.
    WHEN 'IV_WAERS'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_WAERS
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_WAERS.
    WHEN 'IV_BPCODE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BPCODE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_BPCODE.
    WHEN 'IV_AUGDT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_AUGDT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_AUGDT.
    WHEN 'IV_AUGBL'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_AUGBL
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IIV_AUGBL.
  ENDCASE.
ENDFORM.
FORM PARAMETER_READ_OUTPUT USING NAME
                                 KEY
                        CHANGING VALUE.
  CASE NAME.
    WHEN 'IV_BUKRS'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BUKRS
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_GJAHR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_GJAHR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_BELNR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BELNR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_BLART'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BLART
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_BLDAT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BLDAT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_BUDAT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BUDAT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_BLTXT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BLTXT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_XBLNR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_XBLNR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_BSCHL'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BSCHL
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_SAKNR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_SAKNR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_DMBTR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_DMBTR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_WAERS'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_WAERS
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_BPCODE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_BPCODE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_AUGDT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_AUGDT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'IV_AUGBL'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IIV_AUGBL
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'EV_BUKRS'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VEV_BUKRS
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'EV_BELNR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VEV_BELNR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'EV_GJAHR'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VEV_GJAHR
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'EV_ITNUM'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VEV_ITNUM
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  ENDCASE.
ENDFORM.
FORM PARAMETER_COMPARE USING NAME
                       CHANGING VALUE.
  CASE NAME.
    WHEN 'EV_BUKRS'.
      IF %_OEV_BUKRS &lt;&gt; %_VEV_BUKRS.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'EV_BELNR'.
      IF %_OEV_BELNR &lt;&gt; %_VEV_BELNR.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'EV_GJAHR'.
      IF %_OEV_GJAHR &lt;&gt; %_VEV_GJAHR.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'EV_ITNUM'.
      IF %_OEV_ITNUM &lt;&gt; %_VEV_ITNUM.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
  ENDCASE.
ENDFORM.
FORM EXPORT_IMPORT_MEMORY USING SEL KEY STRUCTURE EXPORTKEY.
 CASE SEL.
WHEN 'II'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_IIV_BUKRS
%_IIV_GJAHR
%_IIV_BELNR
%_IIV_BLART
%_IIV_BLDAT
%_IIV_BUDAT
%_IIV_BLTXT
%_IIV_XBLNR
%_IIV_BSCHL
%_IIV_SAKNR
%_IIV_DMBTR
%_IIV_WAERS
%_IIV_BPCODE
%_IIV_AUGDT
%_IIV_AUGBL
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
WHEN 'IO'.
V_RC = RC.
%_VEV_BUKRS = %_OEV_BUKRS.
%_VEV_BELNR = %_OEV_BELNR.
%_VEV_GJAHR = %_OEV_GJAHR.
%_VEV_ITNUM = %_OEV_ITNUM.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_IIV_BUKRS
%_IIV_GJAHR
%_IIV_BELNR
%_IIV_BLART
%_IIV_BLDAT
%_IIV_BUDAT
%_IIV_BLTXT
%_IIV_XBLNR
%_IIV_BSCHL
%_IIV_SAKNR
%_IIV_DMBTR
%_IIV_WAERS
%_IIV_BPCODE
%_IIV_AUGDT
%_IIV_AUGBL
%_VEV_BUKRS
%_VEV_BELNR
%_VEV_GJAHR
%_VEV_ITNUM
TIME1
V_RC
VEXCEPTION
G_UPPER
TO MEMORY ID KEY.
WHEN 'VI'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VEV_BUKRS
%_VEV_BELNR
%_VEV_GJAHR
%_VEV_ITNUM
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
WHEN 'VO'.
V_RC = RC.
%_VEV_BUKRS = %_OEV_BUKRS.
%_VEV_BELNR = %_OEV_BELNR.
%_VEV_GJAHR = %_OEV_GJAHR.
%_VEV_ITNUM = %_OEV_ITNUM.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_VEV_BUKRS
%_VEV_BELNR
%_VEV_GJAHR
%_VEV_ITNUM
TIME1
V_RC
VEXCEPTION
G_UPPER
TO MEMORY ID KEY.
WHEN 'IV'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VEV_BUKRS
%_VEV_BELNR
%_VEV_GJAHR
%_VEV_ITNUM
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
RC = V_RC.
%_OEV_BUKRS = %_VEV_BUKRS.
%_OEV_BELNR = %_VEV_BELNR.
%_OEV_GJAHR = %_VEV_GJAHR.
%_OEV_ITNUM = %_VEV_ITNUM.
  ENDCASE.
ENDFORM.
FORM EXPORT_IMPORT USING SEL KEY STRUCTURE D102N_EXPORTKEY.
 CASE SEL.
WHEN 'II'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_IIV_BUKRS
%_IIV_GJAHR
%_IIV_BELNR
%_IIV_BLART
%_IIV_BLDAT
%_IIV_BUDAT
%_IIV_BLTXT
%_IIV_XBLNR
%_IIV_BSCHL
%_IIV_SAKNR
%_IIV_DMBTR
%_IIV_WAERS
%_IIV_BPCODE
%_IIV_AUGDT
%_IIV_AUGBL
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
WHEN 'IO'.
V_RC = RC.
%_VEV_BUKRS = %_OEV_BUKRS.
%_VEV_BELNR = %_OEV_BELNR.
%_VEV_GJAHR = %_OEV_GJAHR.
%_VEV_ITNUM = %_OEV_ITNUM.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_IIV_BUKRS
%_IIV_GJAHR
%_IIV_BELNR
%_IIV_BLART
%_IIV_BLDAT
%_IIV_BUDAT
%_IIV_BLTXT
%_IIV_XBLNR
%_IIV_BSCHL
%_IIV_SAKNR
%_IIV_DMBTR
%_IIV_WAERS
%_IIV_BPCODE
%_IIV_AUGDT
%_IIV_AUGBL
%_VEV_BUKRS
%_VEV_BELNR
%_VEV_GJAHR
%_VEV_ITNUM
TIME1
V_RC
VEXCEPTION
G_UPPER
TO DATABASE EUFUNC(FL) ID KEY.
WHEN 'VI'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VEV_BUKRS
%_VEV_BELNR
%_VEV_GJAHR
%_VEV_ITNUM
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
WHEN 'VO'.
V_RC = RC.
%_VEV_BUKRS = %_OEV_BUKRS.
%_VEV_BELNR = %_OEV_BELNR.
%_VEV_GJAHR = %_OEV_GJAHR.
%_VEV_ITNUM = %_OEV_ITNUM.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_VEV_BUKRS
%_VEV_BELNR
%_VEV_GJAHR
%_VEV_ITNUM
TIME1
V_RC
VEXCEPTION
G_UPPER
TO DATABASE EUFUNC(FL) ID KEY.
WHEN 'IV'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VEV_BUKRS
%_VEV_BELNR
%_VEV_GJAHR
%_VEV_ITNUM
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
RC = V_RC.
%_OEV_BUKRS = %_VEV_BUKRS.
%_OEV_BELNR = %_VEV_BELNR.
%_OEV_GJAHR = %_VEV_GJAHR.
%_OEV_ITNUM = %_VEV_ITNUM.
  ENDCASE.
ENDFORM.
FORM GET_EXCEPTION_DIFFERENCE
 TABLES DIFFERENCES STRUCTURE UNTERSCHIED.
 IF VEXCEPTION NE OEXCEPTION.
   MOVE 'EXCEPTION' TO DIFFERENCES-PARAMETER.
   IF VEXCEPTION = SPACE.
     MOVE '-' TO DIFFERENCES-ALT.
   ELSE.
     MOVE VEXCEPTION TO DIFFERENCES-ALT.
   ENDIF.
   IF OEXCEPTION = SPACE.
     MOVE '-' TO DIFFERENCES-NEU.
   ELSE.
     MOVE OEXCEPTION TO DIFFERENCES-NEU.
   ENDIF.
   APPEND DIFFERENCES.
  ENDIF.
ENDFORM.
FORM COMPARE_DATA
                  TABLES DIFFERENCES STRUCTURE UNTERSCHIED
                  USING FIELD
                  CHANGING RETCODE.
 DATA : SUBRC LIKE SY-SUBRC.
 field-symbols: &lt;l_f1&gt; type x.
 field-symbols: &lt;l_f2&gt; type x.
 RETCODE = '='.
 CLEAR DIFFERENCES.
 CASE FIELD.
WHEN 'EXCEPTION'.
IF VEXCEPTION NE OEXCEPTION.
RETCODE = SPACE.
MOVE FIELD      TO DIFFERENCES-PARAMETER.
MOVE VEXCEPTION TO DIFFERENCES-ALT.
MOVE OEXCEPTION TO DIFFERENCES-NEU.
APPEND DIFFERENCES.
ENDIF.
  ENDCASE.
ENDFORM.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 758
</font>
</body>
</html>
